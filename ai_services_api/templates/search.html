<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semantic Search Recommendations</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-gray-100">
    <div class="container mx-auto py-8">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-center">Semantic Search</h1>
            <p class="text-center text-gray-400 mt-2">Find relevant results quickly</p>
        </header>

        <main>
            <div class="max-w-md mx-auto">
                <div class="bg-gray-800 rounded-lg shadow-md p-6 border border-gray-700">
                    <form action="/search" method="post" class="space-y-4">
                        <div>
                            <label for="search-input" class="block mb-2 font-medium">Enter your query:</label>
                            <input 
                                type="text" 
                                id="search-input"
                                name="query" 
                                class="bg-gray-700 text-gray-100 rounded-md px-4 py-2 w-full"
                                placeholder="Enter your semantic search query..."
                                autocomplete="off"
                                required
                            >
                        </div>
                        <button type="submit" class="bg-green-500 hover:bg-green-600 text-white font-medium px-4 py-2 rounded-md w-full">Search</button>
                    </form>
                    <div id="autocomplete-list" class="mt-4 bg-gray-700 rounded-md shadow-lg"></div>
                </div>
            </div>
        </main>

        <footer class="mt-8 text-center text-gray-400">
            <p>&copy; 2024 Semantic Search System</p>
        </footer>
    </div>

    <script>
        const searchInput = document.getElementById('search-input');
        const autocompleteList = document.getElementById('autocomplete-list');
        let currentIndex = -1;

        searchInput.addEventListener('input', function() {
            const query = this.value.trim();
            
            if (query.length < 2) {
                autocompleteList.innerHTML = '';
                return;
            }

            fetch(`/autocomplete?query=${encodeURIComponent(query)}`)
                .then(response => response.json())
                .then(suggestions => {
                    autocompleteList.innerHTML = '';
                    if (suggestions.length === 0) {
                        return;
                    }

                    suggestions.forEach((suggestion, index) => {
                        const div = document.createElement('div');
                        div.classList.add('autocomplete-item', 'p-2', 'hover:bg-gray-600', 'cursor-pointer', 'rounded-md');
                        div.innerHTML = `<strong>${suggestion.title}</strong><p class="text-sm text-gray-300">${suggestion.summary}</p>`;
                        
                        div.addEventListener('click', () => {
                            searchInput.value = suggestion.title;
                            autocompleteList.innerHTML = '';
                        });

                        div.addEventListener('mouseenter', () => {
                            setSelectedItem(index);
                        });

                        autocompleteList.appendChild(div);
                    });
                })
                .catch(error => {
                    console.error('Autocomplete error:', error);
                });
        });

        searchInput.addEventListener('keydown', function(event) {
            const items = autocompleteList.getElementsByClassName('autocomplete-item');
            if (event.key === 'ArrowDown') {
                currentIndex = (currentIndex + 1) % items.length;
                setSelectedItem(currentIndex);
                event.preventDefault();
            } else if (event.key === 'ArrowUp') {
                currentIndex = (currentIndex - 1 + items.length) % items.length;
                setSelectedItem(currentIndex);
                event.preventDefault();
            } else if (event.key === 'Enter') {
                if (currentIndex >= 0 && currentIndex < items.length) {
                    searchInput.value = items[currentIndex].querySelector('strong').textContent.trim();
                    autocompleteList.innerHTML = '';
                    event.preventDefault();
                }
            }
        });

        function setSelectedItem(index) {
            const items = autocompleteList.getElementsByClassName('autocomplete-item');
            Array.from(items).forEach((item, i) => {
                item.classList.toggle('bg-gray-600', i === index);
            });
        }

        document.addEventListener('click', function(event) {
            if (!autocompleteList.contains(event.target) && event.target !== searchInput) {
                autocompleteList.innerHTML = '';
            }
        });
    </script>
</body>
</html>
